{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport let perPage = 15;\n\nexport async function fetchImages(query, currentPage = 1) {\n    const API_KEY = '49477848-89e25f92574c797f7074d31b9';\n    const BASE_URL = 'https://pixabay.com/api/';\n\n    try {\n    const response = await axios.get(BASE_URL, {\n        params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: currentPage,\n        per_page: perPage,\n        },\n    });\n\n    if (response.data.hits.length === 0) {\n        iziToast.info({\n        title: 'No results!',\n        message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        });\n        return { images: [], totalHits: 0 };\n    }\n    return { images: response.data.hits, totalHits: response.data.totalHits };\n    } catch (error) {\n    console.error('Error:', error);\n    return { images: [], totalHits: 0 };\n    }\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = null;\n\nexport function initializeLightbox(selector) {\n    lightbox = new SimpleLightbox(selector, {\n    captions: true,\n    captionSelector: 'img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n    });\n}\n\nexport function refreshLightbox() {\n    if (lightbox) {\n    lightbox.refresh();\n    }\n}\n\nexport function renderGallery(container, images) {\n    const markup = images\n    .map(\n        ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        }) => {\n        return `<li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\" class=\"gallery-item-link\">\n            <img class=\"gallery-item-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            </a>\n            <div class=\"info\">\n            <p><b>Likes:</b>${likes}</p>\n            <p><b>Views:</b>${views}</p>\n            <p><b>Comments:</b>${comments}</p>\n            <p><b>Downloads:</b>${downloads}</p>\n            </div>\n        </li>`;\n        }\n    )\n    .join('');\n\n    container.insertAdjacentHTML('beforeend', markup);\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchImages } from './js/pixabay-api';\nimport {\n    renderGallery,\n    initializeLightbox,\n    refreshLightbox,\n} from './js/render-functions';\nimport { perPage } from './js/pixabay-api';\n\nconst refs = {\n    form: document.querySelector('.form'),\n    input: document.querySelector('[name=\"search-text\"]'),\n    gallery: document.querySelector('.gallery'),\n    loader: document.querySelector('.loader'),\n    addImagesBtn: document.querySelector('[type=\"button\"]'),\n};\n\ninitializeLightbox('.gallery a');\n\nlet userRequest = null;\nlet currentPage = 1;\nlet totalPages = 0;\n\nrefs.form.addEventListener('submit', onSearchSubmit);\nrefs.addImagesBtn.addEventListener('click', onLoadMoreClick);\n\nasync function onSearchSubmit(event) {\n    event.preventDefault();\n    currentPage = 1;\n    totalPages = 0;\n    refs.gallery.innerHTML = '';\n    refs.addImagesBtn.classList.add('visually-hidden');\n\n    userRequest = refs.input.value.trim();\n\n    if (userRequest === '') {\n    iziToast.error({\n        title: 'Error:',\n        message: 'Please fill in the search field before submitting!',\n        position: 'topRight',\n    });\n    return;\n    }\n\n    refs.loader.hidden = false;\n\n    try {\n    const { images, totalHits } = await fetchImages(userRequest);\n\n    renderGallery(refs.gallery, images);\n    refreshLightbox();\n\n    totalPages = Math.ceil(totalHits / perPage);\n\n    if (totalPages > currentPage) {\n        refs.addImagesBtn.classList.remove('visually-hidden');\n    }\n    } catch (error) {\n    console.error('Error:', error);\n    } finally {\n    refs.loader.hidden = true;\n    refs.form.reset();\n    }\n}\n\nasync function onLoadMoreClick() {\n    currentPage += 1;\n\n    try {\n    refs.addImagesBtn.classList.add('visually-hidden');\n    refs.loader.hidden = false;\n\n    const { images } = await fetchImages(userRequest, currentPage);\n    renderGallery(refs.gallery, images);\n    refreshLightbox();\n\n    const card = document.querySelector('.gallery-item');\n    const cardHeight = card.getBoundingClientRect().height;\n\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n    });\n\n    if (currentPage >= totalPages) {\n        refs.addImagesBtn.classList.add('visually-hidden');\n        iziToast.info({\n        title: '',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        });\n    } else {\n        refs.addImagesBtn.classList.remove('visually-hidden');\n    }\n    } catch (error) {\n    console.error('Error:', error);\n    } finally {\n    refs.loader.hidden = true;\n    }\n}"],"names":["perPage","fetchImages","query","currentPage","API_KEY","BASE_URL","response","axios","iziToast","error","lightbox","initializeLightbox","selector","SimpleLightbox","refreshLightbox","renderGallery","container","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","userRequest","totalPages","onSearchSubmit","onLoadMoreClick","event","totalHits","cardHeight"],"mappings":"+vBAIO,IAAIA,EAAU,GAEd,eAAeC,EAAYC,EAAOC,EAAc,EAAG,CACtD,MAAMC,EAAU,qCACVC,EAAW,2BAEjB,GAAI,CACJ,MAAMC,EAAW,MAAMC,EAAM,IAAIF,EAAU,CACvC,OAAQ,CACR,IAAKD,EACL,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAUH,CACT,CACT,CAAK,EAED,OAAIM,EAAS,KAAK,KAAK,SAAW,GAC9BE,EAAS,KAAK,CACd,MAAO,cACP,QACI,2EACJ,SAAU,UAClB,CAAS,EACM,CAAE,OAAQ,CAAA,EAAI,UAAW,CAAC,GAE9B,CAAE,OAAQF,EAAS,KAAK,KAAM,UAAWA,EAAS,KAAK,UAC7D,OAAQG,EAAO,CAChB,eAAQ,MAAM,SAAUA,CAAK,EACtB,CAAE,OAAQ,CAAA,EAAI,UAAW,CAAC,CAChC,CACL,CClCA,IAAIC,EAAW,KAER,SAASC,EAAmBC,EAAU,CACzCF,EAAW,IAAIG,EAAeD,EAAU,CACxC,SAAU,GACV,gBAAiB,MACjB,YAAa,OACb,aAAc,MACd,gBAAiB,SACjB,aAAc,GAClB,CAAK,CACL,CAEO,SAASE,GAAkB,CAC1BJ,GACJA,EAAS,QAAO,CAEpB,CAEO,SAASK,EAAcC,EAAWC,EAAQ,CAC7C,MAAMC,EAASD,EACd,IACG,CAAC,CACD,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,uBACQL,CAAa;AAAA,iDACaD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,8BAG7CC,CAAK;AAAA,8BACLC,CAAK;AAAA,iCACFC,CAAQ;AAAA,kCACPC,CAAS;AAAA;AAAA,cAItC,EACA,KAAK,EAAE,EAERT,EAAU,mBAAmB,YAAaE,CAAM,CACpD,CCxCA,MAAMQ,EAAO,CACT,KAAM,SAAS,cAAc,OAAO,EACpC,MAAO,SAAS,cAAc,sBAAsB,EACpD,QAAS,SAAS,cAAc,UAAU,EAC1C,OAAQ,SAAS,cAAc,SAAS,EACxC,aAAc,SAAS,cAAc,iBAAiB,CAC1D,EAEAf,EAAmB,YAAY,EAE/B,IAAIgB,EAAc,KACdxB,EAAc,EACdyB,EAAa,EAEjBF,EAAK,KAAK,iBAAiB,SAAUG,CAAc,EACnDH,EAAK,aAAa,iBAAiB,QAASI,CAAe,EAE3D,eAAeD,EAAeE,EAAO,CASjC,GARAA,EAAM,eAAc,EACpB5B,EAAc,EACdyB,EAAa,EACbF,EAAK,QAAQ,UAAY,GACzBA,EAAK,aAAa,UAAU,IAAI,iBAAiB,EAEjDC,EAAcD,EAAK,MAAM,MAAM,KAAI,EAE/BC,IAAgB,GAAI,CACxBnB,EAAS,MAAM,CACX,MAAO,SACP,QAAS,qDACT,SAAU,UAClB,CAAK,EACD,MACC,CAEDkB,EAAK,OAAO,OAAS,GAErB,GAAI,CACJ,KAAM,CAAE,OAAAT,EAAQ,UAAAe,CAAS,EAAK,MAAM/B,EAAY0B,CAAW,EAE3DZ,EAAcW,EAAK,QAAST,CAAM,EAClCH,IAEAc,EAAa,KAAK,KAAKI,EAAYhC,CAAO,EAEtC4B,EAAazB,GACbuB,EAAK,aAAa,UAAU,OAAO,iBAAiB,CAEvD,OAAQjB,EAAO,CAChB,QAAQ,MAAM,SAAUA,CAAK,CACjC,QAAc,CACViB,EAAK,OAAO,OAAS,GACrBA,EAAK,KAAK,OACT,CACL,CAEA,eAAeI,GAAkB,CAC7B3B,GAAe,EAEf,GAAI,CACJuB,EAAK,aAAa,UAAU,IAAI,iBAAiB,EACjDA,EAAK,OAAO,OAAS,GAErB,KAAM,CAAE,OAAAT,CAAM,EAAK,MAAMhB,EAAY0B,EAAaxB,CAAW,EAC7DY,EAAcW,EAAK,QAAST,CAAM,EAClCH,IAGA,MAAMmB,EADO,SAAS,cAAc,eAAe,EAC3B,sBAAqB,EAAG,OAEhD,OAAO,SAAS,CACZ,IAAKA,EAAa,EAClB,SAAU,QAClB,CAAK,EAEG9B,GAAeyB,GACfF,EAAK,aAAa,UAAU,IAAI,iBAAiB,EACjDlB,EAAS,KAAK,CACd,MAAO,GACP,QAAS,6DACT,SAAU,UAClB,CAAS,GAEDkB,EAAK,aAAa,UAAU,OAAO,iBAAiB,CAEvD,OAAQjB,EAAO,CAChB,QAAQ,MAAM,SAAUA,CAAK,CACjC,QAAc,CACViB,EAAK,OAAO,OAAS,EACpB,CACL"}